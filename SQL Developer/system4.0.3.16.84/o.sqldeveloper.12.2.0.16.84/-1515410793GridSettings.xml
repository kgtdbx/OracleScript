<?xml version = '1.0' encoding = 'UTF-8'?>
<TableSettings class="oracle.dbtools.raptor.controls.grid.RaptorGridPersistedSettings" xmlns="http://xmlns.oracle.com/jdeveloper/110000/Table-attributes">
   <columnPositions class="java.util.ArrayList">
      <Item class="java.lang.String">020_group_code</Item>
      <Item class="java.lang.String">'030_1'</Item>
      <Item class="java.lang.String">'040_1_2'</Item>
      <Item class="java.lang.String">'050_2_3'</Item>
      <Item class="java.lang.String">'060_3_4'</Item>
      <Item class="java.lang.String">'070_4_5'</Item>
      <Item class="java.lang.String">'080_5_6'</Item>
      <Item class="java.lang.String">'090_6_7'</Item>
      <Item class="java.lang.String">'100_7_8'</Item>
      <Item class="java.lang.String">'110_8_9'</Item>
      <Item class="java.lang.String">'120_9_10'</Item>
      <Item class="java.lang.String">'130_10_11'</Item>
      <Item class="java.lang.String">'140_11_12'</Item>
      <Item class="java.lang.String">'150_12_15'</Item>
      <Item class="java.lang.String">'160_15_18'</Item>
      <Item class="java.lang.String">'170_18_21'</Item>
      <Item class="java.lang.String">'180_21_24'</Item>
      <Item class="java.lang.String">'190_24_27'</Item>
      <Item class="java.lang.String">'200_27_30'</Item>
      <Item class="java.lang.String">'210_30_33'</Item>
      <Item class="java.lang.String">'220_33_36'</Item>
      <Item class="java.lang.String">'230_3_5'</Item>
      <Item class="java.lang.String">'240_5_10'</Item>
      <Item class="java.lang.String">'250_10'</Item>
      <Item class="java.lang.String">'260_und'</Item>
   </columnPositions>
   <columnWidths>
      <Item>100</Item>
      <Item>82</Item>
      <Item>65</Item>
      <Item>65</Item>
      <Item>65</Item>
      <Item>65</Item>
      <Item>65</Item>
      <Item>68</Item>
      <Item>65</Item>
      <Item>68</Item>
      <Item>71</Item>
      <Item>77</Item>
      <Item>77</Item>
      <Item>77</Item>
      <Item>77</Item>
      <Item>77</Item>
      <Item>77</Item>
      <Item>77</Item>
      <Item>77</Item>
      <Item>77</Item>
      <Item>77</Item>
      <Item>68</Item>
      <Item>71</Item>
      <Item>68</Item>
      <Item>65</Item>
   </columnWidths>
   <searchParams class="java.util.ArrayList"/>
   <sortClauses>
      <Item/>
   </sortClauses>
   <uniqueName>IdeConnections%23VHGTEST_VALHOLLwith stmt_xbrl_dates as  
(select to_date(capital_date, 'DD.MM.YYYY') as capital_date,  
        to_date(htv_date, 'DD.MM.YYYY')     as htv_date  
  from  mimir.xbrl_dates) 

,CF as 
( 
select * from 
( 
  select 
  x.code "010_code", 
  x.group_ssn "020_group_code", 
  case when months_between(cf_dt.the_date, cf.the_date) &lt;= 1 then '030_1' 
  when months_between(cf_dt.the_date, cf.the_date) between 1 and 2 then '040_1_2' 
  when months_between(cf_dt.the_date, cf.the_date) between 2 and 3 then '050_2_3' 
  when months_between(cf_dt.the_date, cf.the_date) between 3 and 4 then '060_3_4' 
  when months_between(cf_dt.the_date, cf.the_date) between 4 and 5 then '070_4_5' 
  when months_between(cf_dt.the_date, cf.the_date) between 5 and 6 then '080_5_6' 
  when months_between(cf_dt.the_date, cf.the_date) between 6 and 7 then '090_6_7' 
  when months_between(cf_dt.the_date, cf.the_date) between 7 and 8 then '100_7_8' 
  when months_between(cf_dt.the_date, cf.the_date) between 8 and 9 then '110_8_9' 
  when months_between(cf_dt.the_date, cf.the_date) between 9 and 10 then '120_9_10' 
  when months_between(cf_dt.the_date, cf.the_date) between 10 and 11 then '130_10_11' 
  when months_between(cf_dt.the_date, cf.the_date) between 11 and 12 then '140_11_12' 
  when months_between(cf_dt.the_date, cf.the_date) between 12 and 15 then '150_12_15' 
  when months_between(cf_dt.the_date, cf.the_date) between 15 and 18 then '160_15_18' 
  when months_between(cf_dt.the_date, cf.the_date) between 18 and 21 then '170_18_21' 
  when months_between(cf_dt.the_date, cf.the_date) between 21 and 24 then '180_21_24' 
  when months_between(cf_dt.the_date, cf.the_date) between 24 and 27 then '190_24_27' 
  when months_between(cf_dt.the_date, cf.the_date) between 27 and 30 then '200_27_30' 
  when months_between(cf_dt.the_date, cf.the_date) between 30 and 33 then '210_30_33' 
  when months_between(cf_dt.the_date, cf.the_date) between 33 and 36 then '220_33_36' 
  when months_between(cf_dt.the_date, cf.the_date)/12 between 3 and 5 then '230_3_5' 
  when months_between(cf_dt.the_date, cf.the_date)/12 between 5 and 10 then '240_5_10' 
  when months_between(cf_dt.the_date, cf.the_date)/12 > 10 then '250_10' 
  else '260_und' end bucket,round(sum(cf.installment_isk),0) installment_isk 
  from 
  valholl.fct_loan_cashflow_a_v cf 
  left join valholl.dim_customer_a_v dc on cf.dim_customer = dc.dimension_key 
  inner join mimir.v_crd_large_exposure_c27 x on dc.cust_ssn = x.code and x."Type" in ('I - Institutions','U - Unregulated financial entities') 
  left join valholl.dim_time_a_v cf_dt on cf.dim_time_transaction = cf_dt.dimension_key 
  left join valholl.dim_loan_type_a_v lt on cf.dim_loan_type = lt.dimension_key 
  where 
  cf.the_date = (select htv_date from stmt_xbrl_dates)  
  and nvl(cf.asset_liability,0) &lt;> 'l' and cf.installment_isk > 0 
  
  and dc.internal_ssn = 'No' 
  group by x.code,x.group_ssn,  case when months_between(cf_dt.the_date, cf.the_date) &lt;= 1 then '030_1' 
  when months_between(cf_dt.the_date, cf.the_date) between 1 and 2 then '040_1_2' 
  when months_between(cf_dt.the_date, cf.the_date) between 2 and 3 then '050_2_3' 
  when months_between(cf_dt.the_date, cf.the_date) between 3 and 4 then '060_3_4' 
  when months_between(cf_dt.the_date, cf.the_date) between 4 and 5 then '070_4_5' 
  when months_between(cf_dt.the_date, cf.the_date) between 5 and 6 then '080_5_6' 
  when months_between(cf_dt.the_date, cf.the_date) between 6 and 7 then '090_6_7' 
  when months_between(cf_dt.the_date, cf.the_date) between 7 and 8 then '100_7_8' 
  when months_between(cf_dt.the_date, cf.the_date) between 8 and 9 then '110_8_9' 
  when months_between(cf_dt.the_date, cf.the_date) between 9 and 10 then '120_9_10' 
  when months_between(cf_dt.the_date, cf.the_date) between 10 and 11 then '130_10_11' 
  when months_between(cf_dt.the_date, cf.the_date) between 11 and 12 then '140_11_12' 
  when months_between(cf_dt.the_date, cf.the_date) between 12 and 15 then '150_12_15' 
  when months_between(cf_dt.the_date, cf.the_date) between 15 and 18 then '160_15_18' 
  when months_between(cf_dt.the_date, cf.the_date) between 18 and 21 then '170_18_21' 
  when months_between(cf_dt.the_date, cf.the_date) between 21 and 24 then '180_21_24' 
  when months_between(cf_dt.the_date, cf.the_date) between 24 and 27 then '190_24_27' 
  when months_between(cf_dt.the_date, cf.the_date) between 27 and 30 then '200_27_30' 
  when months_between(cf_dt.the_date, cf.the_date) between 30 and 33 then '210_30_33' 
  when months_between(cf_dt.the_date, cf.the_date) between 33 and 36 then '220_33_36' 
  when months_between(cf_dt.the_date, cf.the_date)/12 between 3 and 5 then '230_3_5' 
  when months_between(cf_dt.the_date, cf.the_date)/12 between 5 and 10 then '240_5_10' 
  when months_between(cf_dt.the_date, cf.the_date)/12 > 10 then '250_10' 
  else '260_und' end 
) 
pivot 
( 
sum(installment_isk) 
for bucket 
in ('030_1','040_1_2','050_2_3','060_3_4','070_4_5','080_5_6','090_6_7','100_7_8','110_8_9','120_9_10','130_10_11','140_11_12','150_12_15','160_15_18','170_18_21','180_21_24','190_24_27','200_27_30','210_30_33','220_33_36','230_3_5','240_5_10','250_10','260_und') 
) 
) 
 
 
select "020_group_code","'030_1'","'040_1_2'","'050_2_3'","'060_3_4'","'070_4_5'","'080_5_6'","'090_6_7'","'100_7_8'","'110_8_9'","'120_9_10'","'130_10_11'","'140_11_12'","'150_12_15'","'160_15_18'","'170_18_21'","'180_21_24'","'190_24_27'","'200_27_30'","'210_30_33'","'220_33_36'","'230_3_5'","'240_5_10'","'250_10'","'260_und'"/*,a.credit_risk_exposure*/ from CF c</uniqueName>
</TableSettings>
