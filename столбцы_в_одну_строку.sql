
SELECT * FROM (SELECT LTRIM(SYS_CONNECT_BY_PATH(CODE, ','),',') AS "PATH"
                FROM (SELECT SA.CODE, LAG(SA.CODE) OVER (ORDER BY SA.CODE) AS CODE_1
                      FROM JAN.SALES_AUDIT SA
                      WHERE SA.CODE IN ('1014036970','1014435224','1015056929','1015366239','1015898504')
                      and   SA.CUSTOMER_NO = '1037700'
                      )
              START WITH CODE_1 IS NULL
              CONNECT BY  CODE_1 = PRIOR CODE
              ORDER BY 1 DESC)
WHERE ROWNUM = 1;
--#############################
SELECT RTRIM(XMLAGG(XMLELEMENT(e,SA.CODE,',').EXTRACT('//text()')),',') GROUPNAME
FROM JAN.SALES_AUDIT SA
WHERE SA.CODE IN ('1014036970','1014435224','1015056929','1015366239','1015898504')
and   SA.CUSTOMER_NO = '1037700'

